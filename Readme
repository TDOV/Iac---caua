üìù README: Infraestrutura e Automa√ß√£o da Aplica√ß√£o

Este projeto utiliza Terraform para provisionar a infraestrutura na Azure e Ansible para automatizar o deploy (entrega) da aplica√ß√£o em cont√™ineres Docker.

üíª 1. Componentes de Infraestrutura (Terraform)

Os arquivos Terraform (main.tf, variables.tf, outputs.tf) definem e provisionam os recursos b√°sicos necess√°rios no Microsoft Azure.

terraform/main.tf

Este arquivo √© o n√∫cleo da infraestrutura e define os seguintes recursos:

    Provedor (azurerm): Utiliza a vers√£o ~> 3.0 do provedor Azure.

Rede Virtual (azurerm_virtual_network): Cria uma VNet chamada vnet-pratica com o espa√ßo de endere√ßo 10.0.0.0/16.

Sub-rede (azurerm_subnet): Cria uma sub-rede chamada subnet-pratica com o prefixo de endere√ßo 10.0.1.0/24.

IP P√∫blico (azurerm_public_ip): Cria um IP P√∫blico chamado pip-pratica-vm com m√©todo de aloca√ß√£o Static e SKU Standard.

Grupo de Seguran√ßa de Rede (NSG): Cria nsg-pratica com duas regras de seguran√ßa de entrada (Inbound):

    AllowSSH: Permite tr√°fego TCP na porta 22 (SSH) de qualquer origem (*).

AllowHTTP: Permite tr√°fego TCP na porta 80 (HTTP) de qualquer origem (*).

Interface de Rede (azurerm_network_interface): Cria nic-pratica-vm, associando-a √† sub-rede e ao IP p√∫blico provisionados.

Associa√ß√£o NSG: Conecta o NSG (nsg-pratica) √† interface de rede.

M√°quina Virtual Linux (azurerm_linux_virtual_machine):

    Nome: vm-pratica.

Tamanho: Definido pela vari√°vel var.vm_size.

Imagem Base: Ubuntu Server 22.04 LTS (Jammy).

Autentica√ß√£o: Utiliza uma chave SSH p√∫blica, cujo caminho √© fornecido pela vari√°vel var.ssh_public_key_path.

terraform/variables.tf

Define as vari√°veis de entrada necess√°rias para o provisionamento do Terraform:
Vari√°vel	Tipo	Descri√ß√£o	Valor Padr√£o (Default)
resource_group_name	

string

	

O nome do grupo de recursos.

	(Nenhum)
location	

string
	

	

A regi√£o do Azure.

	(Nenhum)
vm_size	

string
	

	Tamanho da VM.	

Standard_B2s

admin_username	

string
	

	Nome de usu√°rio administrador da VM.	

azureuser

ssh_public_key_path	

string
	

	

Caminho para a chave p√∫blica SSH.

	(Nenhum)

terraform/outputs.tf

Define os valores que s√£o retornados ap√≥s a execu√ß√£o do Terraform, sendo o principal:

    public_ip_address: O endere√ßo de IP p√∫blico da M√°quina Virtual , obtido do recurso azurerm_linux_virtual_machine.vm.

gitignore

Lista arquivos que n√£o devem ser versionados pelo Git, incluindo arquivos de estado do Terraform (terraform.tfstate, .terraform, etc.) e credenciais (azure_credentials.txt, terraform.tfvars).

üõ†Ô∏è 2. Automa√ß√£o da Aplica√ß√£o (Ansible)

Os arquivos Ansible s√£o respons√°veis por configurar o ambiente na VM provisionada e realizar o deploy da aplica√ß√£o em Docker.

ansible/playbook.yml

Este playbook √© o roteiro de automa√ß√£o, executando as seguintes etapas na VM (hosts: all):

    Instala√ß√£o do Docker: Instala os pr√©-requisitos (apt, git, python3-pip), adiciona o reposit√≥rio oficial do Docker e instala o docker-ce.

    Configura√ß√£o do Docker: Instala o Docker SDK para Ansible (pip), adiciona o usu√°rio ao grupo docker e garante que o servi√ßo esteja rodando.

    Prepara√ß√£o: Cria uma rede Docker chamada app_network e o diret√≥rio /opt/app_source.

    Deploy do Backend:

        Clona o reposit√≥rio do backend (pratica-backend.git) no branch dev.

        Faz o build da imagem Docker.

        Inicia o cont√™iner na porta 8080 dentro da app_network.

    Deploy do Frontend:

        Clona o reposit√≥rio do frontend (pratica-frontend.git) no branch dev.

        Faz o build da imagem Docker.

        Inicia o cont√™iner na porta 80 (permitindo acesso via navegador) dentro da app_network, passando a URL do backend como vari√°vel de ambiente (BACKEND_URL=http://pratica-backend:8080).

ansible/group_vars/all.yml

Define vari√°veis globais para o playbook:
Componente	Vari√°vel	Valor
Backend	repo	https://github.com/william-prof/pratica-backend.git
	branch	dev
	container_name	pratica-backend
Frontend	repo	https://github.com/william-prof/pratica-frontend.git
	branch	dev
	container_name	pratica-frontend

ansible/inventory/hosts.sample

√â um arquivo de invent√°rio de exemplo para o Ansible, mostrando como conectar na VM via SSH:

[azure_vm]
<IP_DA_VM> ansible_user=<NOME_USUARIO> ansible_ssh_private_key_file=<CAMINHO_CHAVE_RSA>

üåê 3. Arquivos Web (Est√°tico)

O arquivo index.html √© um esqueleto de p√°gina web simples.

index.html

    Prop√≥sito: √â a p√°gina inicial (Home) de um site simples.

    Estrutura: Cont√©m um t√≠tulo principal e uma barra de navega√ß√£o com links para index.html, about.html, lorenzo.html e heitor.html.

    Estilo: Faz refer√™ncia a um arquivo de estilos style.css (n√£o fornecido).
